[TestClean]
Src = Expr0[variant]  -  Expr0[base]  /  Expr2[base]  +  10

[TestUnsafeSql]
Src_2  = Expr0[variant] -- Expr0[base]
Src_3  = "Expr0[variant] -; Expr0[base]"
Src_4  = Expr0[variant] \ Expr0[base]
Src_5  = Expr0[variant]--Expr0[base]
Src_6  = "Expr0[variant]-;Expr0[base]"
Src_7  = Expr0[variant]\Expr0[base]

Src_20  = Expr0[variant] -DELETE Expr0[base]
Src_21  = Expr0[variant] - Expr0[base]INSERT
Src_22  = UPDATE Expr0[variant] - Expr0[base]
Src_23  = EXEC[variant] - Expr0[base]
Src_24  = Expr0[variant] -GO[base]
Src_25  = Expr0[variant] '-'MERGE'[base]'
Src_26  = Expr0[variant] '-'''CREATE'[base]'
Src_27 = Expr0[variant] - Expr0[base]''GRANT
Src_28 = REVOKE'Expr0'[variant] - Expr0[base]

Src_30 = Expr0[variant] DELETE2-DELETE Expr0[base]
Src_31 = Expr0[variant] -INSERT2 Expr0[base]INSERT
Src_32 = UPDATE2 UPDATE Expr0[variant] - Expr0[base]
Src_33 = EXEC2 EXEC[variant] - Expr0[base]
Src_34 = Expr0[variant] GO2-GO[base]
Src_35 = Expr0[variant] ''MERGE2'-'MERGE'[base]'
Src_36 = Expr0[variant] ''''CREATE''-''CREATE'[base]'
Src_37 = Expr0[variant] - Expr0[base]''GRANT2''GRANT
Src_38 = REVOKE2''REVOKE'Expr0'[variant] - Expr0[base]


[TestTranslateSimpleFnc]
Src_2    = Expr0[variant] - Expr0[base]
Valid_2  = Expr0[variant] - Expr0[base]

Src_3    = OM_IF(Expr0[variant] - Expr0[base] > 1.5 THEN Expr0[variant] - Expr0[base] ELSE 1.5)
Valid_3  = CASE WHEN Expr0[variant] - Expr0[base] > 1.5 THEN Expr0[variant] - Expr0[base] ELSE 1.5 END

Src_4    = OM_DENOM(Expr0[variant] - Expr0[base])
Valid_4  = CASE WHEN ABS(Expr0[variant] - Expr0[base]) > 1.0e-37 THEN Expr0[variant] - Expr0[base] ELSE NULL END

Src_5    = OM_IF( Expr0[variant] - Expr0[base] > 1.5 THEN Expr0[variant] - Expr0[base] ELSE 1.5 )
Valid_5  = CASE WHEN  Expr0[variant] - Expr0[base] > 1.5 THEN Expr0[variant] - Expr0[base] ELSE 1.5  END

Src_6    = OM_DENOM     (( SQRT(ABS(Expr0[variant] - Expr0[base])) ))
Valid_6  = CASE WHEN ABS(( SQRT(ABS(Expr0[variant] - Expr0[base])) )) > 1.0e-37 THEN ( SQRT(ABS(Expr0[variant] - Expr0[base])) ) ELSE NULL END

Src_7    = OM_IF( OM_IF(Expr0 > 1.5 THEN Expr0 ELSE 1.5) < 2 THEN 2 ELSE OM_IF(Expr0 > 1.5 THEN Expr0 ELSE 1.5) )
Valid_7  = CASE WHEN  CASE WHEN Expr0 > 1.5 THEN Expr0 ELSE 1.5 END < 2 THEN 2 ELSE CASE WHEN Expr0 > 1.5 THEN Expr0 ELSE 1.5 END  END

Src_8    = "  OM_IF( OM_IF(Expr0 > 1.5 THEN Expr0 ELSE 1.5) < 2 THEN 2 ELSE OM_IF(Expr0 > 1.5 THEN Expr0 ELSE 1.5) )  "
Valid_8  = "  CASE WHEN  CASE WHEN Expr0 > 1.5 THEN Expr0 ELSE 1.5 END < 2 THEN 2 ELSE CASE WHEN Expr0 > 1.5 THEN Expr0 ELSE 1.5 END  END  "

Src_9    = '' + Expr0[variant] - Expr0[base]
Valid_9  = '' + Expr0[variant] - Expr0[base]

Src_10    = "'ab' + 'cd'Expr0[variant]'e''f'- Expr0[base] + 'gh'"
Valid_10  = "'ab' + 'cd'Expr0[variant]'e''f'- Expr0[base] + 'gh'"

Src_11    = OM_DENOM     ( SQRT(ABS(v)) / OM_DENOM(w)/OM_DENOM(x/OM_DENOM(y)) )
Valid_11  = CASE WHEN ABS( SQRT(ABS(v)) / CASE WHEN ABS(w) > 1.0e-37 THEN w ELSE NULL END/CASE WHEN ABS(x/CASE WHEN ABS(y) > 1.0e-37 THEN y ELSE NULL END) > 1.0e-37 THEN x/CASE WHEN ABS(y) > 1.0e-37 THEN y ELSE NULL END ELSE NULL END ) > 1.0e-37 THEN  SQRT(ABS(v)) / CASE WHEN ABS(w) > 1.0e-37 THEN w ELSE NULL END/CASE WHEN ABS(x/CASE WHEN ABS(y) > 1.0e-37 THEN y ELSE NULL END) > 1.0e-37 THEN x/CASE WHEN ABS(y) > 1.0e-37 THEN y ELSE NULL END ELSE NULL END  ELSE NULL END

Src_21    = OM_IF(Expr0 > 2 + 'ab' THEN Expr0 ELSE 2)
Valid_21  = CASE WHEN Expr0 > 2 + 'ab' THEN Expr0 ELSE 2 END

Src_22    = OM_IF(Expr0 > 2 + 'ef' THEN Expr0 ELSE 2 + 'km')
Valid_22  = CASE WHEN Expr0 > 2 + 'ef' THEN Expr0 ELSE 2 + 'km' END

Src_23    = 'ab'+OM_IF(Expr0 > 2 THEN Expr0 ELSE 2)
Valid_23  = 'ab'+CASE WHEN Expr0 > 2 THEN Expr0 ELSE 2 END

Src_24    = 'ab' + OM_IF(Expr0 > 2 THEN Expr0 ELSE 2)
Valid_24  = 'ab' + CASE WHEN Expr0 > 2 THEN Expr0 ELSE 2 END

Src_25    = OM_IF('cd' + Expr0 > 2 THEN Expr0 ELSE 2 + 'km')
Valid_25  = CASE WHEN 'cd' + Expr0 > 2 THEN Expr0 ELSE 2 + 'km' END

Src_26    = "'ab'+OM_IF('cd' + Expr0 > 2''THEN'ef'Expr0 ELSE 2 + 'km') 'rs'"
Valid_26  = "'ab'+CASE WHEN 'cd' + Expr0 > 2''THEN'ef'Expr0 ELSE 2 + 'km' END 'rs'"

Src_27    = "'ab'+OM_IF('cd' + Expr0 > 2''THEN'ef'Expr0 ELSE 2 + 'km')'rs'"
Valid_27  = "'ab'+CASE WHEN 'cd' + Expr0 > 2''THEN'ef'Expr0 ELSE 2 + 'km' END'rs'"

Src_28    = "'ab'+OM_IF('cd'-OM_IF(Expr0'ef'> 1 THEN Expr0 ELSE 1'gh')'ij'< 2 THEN 2 ELSE 'km'-OM_IF(Expr0 > 3 THEN Expr0 ELSE 4)'np')'rs'"
Valid_28  = "'ab'+CASE WHEN 'cd'-CASE WHEN Expr0'ef'> 1 THEN Expr0 ELSE 1'gh' END'ij'< 2 THEN 2 ELSE 'km'-CASE WHEN Expr0 > 3 THEN Expr0 ELSE 4 END'np' END'rs'"

[TranslateToExprSql]
ModelName      = modelOne
ModelDigest    = 
DbPath         = ../../../modelOne.sqlite
TableName      = salarySex

Comparison_1   = expr0 - expr1
BaseRunId_1    = 101
RunIds_1       = 102,105
Valid_1        = WITH cs0 (run_id, dim0, dim1, src0) AS (SELECT BR.run_id, C.dim0, C.dim1, C.expr_value FROM salarySex_v_2012882 C INNER JOIN run_table BR ON (BR.base_run_id = C.run_id AND BR.table_hid = 82) WHERE C.expr_id = 0), cs1 (run_id, dim0, dim1, src1) AS (SELECT BR.run_id, C.dim0, C.dim1, C.expr_value FROM salarySex_v_2012882 C INNER JOIN run_table BR ON (BR.base_run_id = C.run_id AND BR.table_hid = 82) WHERE C.expr_id = 1), cr (run_id, dim0, dim1, val) AS (SELECT B.run_id, B.dim0, B.dim1, B.src0 - B1.src1 FROM cs0 B INNER JOIN cs1 B1 ON (B1.run_id = B.run_id AND B1.dim0 = B.dim0 AND B1.dim1 = B.dim1)) SELECT C.run_id, C.dim0, C.dim1, C.val FROM cr C WHERE C.run_id IN (101, 102, 105) ORDER BY 1, 2, 3

Comparison_2   = expr1[variant] + expr0[base]
BaseRunId_2    = 101
RunIds_2       = 102,105
Valid_2        = WITH cs0 (run_id, dim0, dim1, src0) AS (SELECT BR.run_id, C.dim0, C.dim1, C.expr_value FROM salarySex_v_2012882 C INNER JOIN run_table BR ON (BR.base_run_id = C.run_id AND BR.table_hid = 82) WHERE C.expr_id = 0), cs1 (run_id, dim0, dim1, src1) AS (SELECT BR.run_id, C.dim0, C.dim1, C.expr_value FROM salarySex_v_2012882 C INNER JOIN run_table BR ON (BR.base_run_id = C.run_id AND BR.table_hid = 82) WHERE C.expr_id = 1), cr (run_id, dim0, dim1, val) AS (SELECT V.run_id, V.dim0, V.dim1, V.src1 + B.src0 FROM cs0 B INNER JOIN cs1 V ON (V.dim0 = B.dim0 AND V.dim1 = B.dim1) WHERE B.run_id = 101) SELECT C.run_id, C.dim0, C.dim1, C.val FROM cr C WHERE C.run_id IN (102, 105) ORDER BY 1, 2, 3

Comparison_3   = (expr1 + expr2) / OM_DENOM(expr0)
BaseRunId_3    = 101
RunIds_3       = 102,105
Valid_3        = WITH cs0 (run_id, dim0, dim1, src0) AS (SELECT BR.run_id, C.dim0, C.dim1, C.expr_value FROM salarySex_v_2012882 C INNER JOIN run_table BR ON (BR.base_run_id = C.run_id AND BR.table_hid = 82) WHERE C.expr_id = 0), cs1 (run_id, dim0, dim1, src1) AS (SELECT BR.run_id, C.dim0, C.dim1, C.expr_value FROM salarySex_v_2012882 C INNER JOIN run_table BR ON (BR.base_run_id = C.run_id AND BR.table_hid = 82) WHERE C.expr_id = 1), cs2 (run_id, dim0, dim1, src2) AS (SELECT BR.run_id, C.dim0, C.dim1, C.expr_value FROM salarySex_v_2012882 C INNER JOIN run_table BR ON (BR.base_run_id = C.run_id AND BR.table_hid = 82) WHERE C.expr_id = 2), cr (run_id, dim0, dim1, val) AS (SELECT B.run_id, B.dim0, B.dim1, (B1.src1 + B2.src2) / CASE WHEN ABS(B.src0) > 1.0e-37 THEN B.src0 ELSE NULL END FROM cs0 B INNER JOIN cs1 B1 ON (B1.run_id = B.run_id AND B1.dim0 = B.dim0 AND B1.dim1 = B.dim1) INNER JOIN cs2 B2 ON (B2.run_id = B.run_id AND B2.dim0 = B.dim0 AND B2.dim1 = B.dim1)) SELECT C.run_id, C.dim0, C.dim1, C.val FROM cr C WHERE C.run_id IN (101, 102, 105) ORDER BY 1, 2, 3

Comparison_4   = (expr1[base] + expr1[variant] + expr0[variant]) / OM_DENOM(expr0[base])
BaseRunId_4    = 101
RunIds_4       = 102,105
Valid_4        = WITH cs0 (run_id, dim0, dim1, src0) AS (SELECT BR.run_id, C.dim0, C.dim1, C.expr_value FROM salarySex_v_2012882 C INNER JOIN run_table BR ON (BR.base_run_id = C.run_id AND BR.table_hid = 82) WHERE C.expr_id = 0), cs1 (run_id, dim0, dim1, src1) AS (SELECT BR.run_id, C.dim0, C.dim1, C.expr_value FROM salarySex_v_2012882 C INNER JOIN run_table BR ON (BR.base_run_id = C.run_id AND BR.table_hid = 82) WHERE C.expr_id = 1), cr (run_id, dim0, dim1, val) AS (SELECT V.run_id, V.dim0, V.dim1, (B1.src1 + V1.src1 + V.src0) / CASE WHEN ABS(B.src0) > 1.0e-37 THEN B.src0 ELSE NULL END FROM cs0 B INNER JOIN cs1 B1 ON (B1.run_id = B.run_id AND B1.dim0 = B.dim0 AND B1.dim1 = B.dim1) INNER JOIN cs0 V ON (V.dim0 = B.dim0 AND V.dim1 = B.dim1) INNER JOIN cs1 V1 ON (V1.run_id = B.run_id AND V1.dim0 = B.dim0 AND V1.dim1 = B.dim1) WHERE B.run_id = 101) SELECT C.run_id, C.dim0, C.dim1, C.val FROM cr C WHERE C.run_id IN (102, 105) ORDER BY 1, 2, 3

[CompareOutputTable]
ModelName      = modelOne
ModelDigest    = 
DbPath         = ../../../modelOne.sqlite
TableName      = salarySex

Comparison_1   = expr0 - expr1
IsAcc_1        = false
BaseRunId_1    = 101
RunIds_1       = 102,105

; Comparison  = expr0[variant] / OM_DENOM(expr0[base])
; Comparison  = expr0[variant] - OM_IF( expr0[base] > 0.1 THEN expr0[base] ELSE 0.1 )
